import{d as B,o as b,$ as E,a5 as k,q,ag as x,a as F,k as P,m as j,n as A,s as C}from"./index-aae22775.js";const L=B({name:"LayForm",__name:"index",props:{model:{default:function(){return{}}},required:{type:Boolean},rules:{},size:{},mode:{},pane:{type:Boolean,default:!1},initValidate:{type:Boolean,default:!1},useCN:{type:Boolean,default:!0},labelPosition:{default:"right"},labelWidth:{},inlineWidth:{},requiredIcons:{default:""},requiredErrorMessage:{},validateMessage:{},isLabelTooltip:{type:Boolean,default:!1},tooltipProps:{}},emits:["submit"],setup(m,{expose:y,emit:h}){const n=m,o=[],r={},v=h;b(()=>{var t;n.initValidate&&((t=c())==null||t.catch(e=>{}))});const g=function(t){t.preventDefault();let e=!1;return c((a,l,s)=>{e=a,v("submit",a,l,s)}),e},c=async function(t,e){let a=o;typeof t=="function"?e=t:(typeof t=="string"||Array.isArray(t)&&t.length>0)&&(a=[],(t?[].concat(t):[]).forEach(i=>r[i]&&a.push(r[i])));let l=[];for(const i of a){const u=await i.validate();l=l.concat(u==null?void 0:u.errors).filter(Boolean)}const s=l.length===0;return typeof e=="function"?(s?e(!0,n.model,null):e(!1,n.model,l),null):new Promise((i,u)=>{const p={isValidate:s,model:n.model,errors:s?null:l};p.isValidate?i(p):u(p)})},d=function(t){const e=t?[].concat(t):[];e.length===0?o.forEach(a=>a.clearValidate()):e.forEach(a=>r[a]&&r[a].clearValidate())};function f(t,e){const a=t.replace(/\[(\d+)\]/g,".$1").split("."),l=a.shift();if(l!==void 0)return e==null||typeof e!="object"?null:a.length===0?(e[l]instanceof Array?e[l]=[]:e[l]=null,e):(e[l]=f(a.join("."),e[l]),e)}const V=t=>{for(var e=0;e<o.length;e++)o[e].prop!=null&&f(o[e].prop,t)};return y({validate:c,clearValidate:d,reset:function(){V(n.model),E(()=>d())}}),k("LayForm",q({formItems:o,addField:function(t){o.push(t),r[t.prop]=t},removeField:function(t){for(var e=0;e<o.length;e++)o[e].prop==t.prop&&o.splice(e,1);t.prop!=null&&Reflect.deleteProperty(r,t.prop)},clearValidate:d,validate:c,...x(n)})),(t,e)=>(F(),P("form",{class:A(["layui-form",{"layui-form-pane":t.pane}]),onsubmit:g},[j(t.$slots,"default")],2))}}),$=C(L);export{$ as a};
